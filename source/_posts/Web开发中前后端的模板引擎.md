---
title: Web开发中前后端的模板引擎
comment: true
date: 2017-05-23 16:45:12
tags: [jade,模板引擎,angualr,mvc,Nodejs]
---

最近在学习Node.js，所以想自己实践一个用Node做后端的小项目，过程中不可避免的涉及到了模板引擎的问题。但在选择模板引擎的时被五花八门的模板引擎迷了眼。搜索到的java使用的模板有velocity、FreeMarker，Node使用的模板引擎jade、Ejs、Swig等等，甚至连一直使用的Angular等前端开发框架也成了模板引擎？这让我陷入了深深地自我怀疑，现在就来看一下模板引擎到底是什么鬼。

# 1. 模板引擎是什么？

模板，就是指有固定的格式，可以生成多个实例的样板。

代码中的模板就是几个变量，允许我们自己塞入数据。举个例子：

``` javascript
// 模板
var tpl = 'Hei, my name is <%name%>, and I\'m <%age%> years old.';
```

``` javascript
var data = {
    "name": "zproo",
    "age": "20"
};
var result = tplEngine(tpl, data);   // 通过模板引擎将数据给到模板
```

这就是一个模板引擎干的事情。

# 2. 模板引擎的意义

## 2.1 后端模板引擎

说模板引擎，要从后端说起。现在后端开发基本是MVC的架构模式。从Model层获取数据，然后将数据传到 View 层渲染（渲染成 HTML 文件），而 View 层，一般都会用到模板引擎。

大体过程是这样的：

![mvc](http://ortur5wom.bkt.clouddn.com/mvc.gif)

### 2.1.1 传统方式的缺点

后端模板引擎最常见的使用java之类的后端语言模板，这样做有利于 SEO，并且与前端请求接口的方式相比，少了个 HTTP 请求，理论上加载速度可能会稍微快些。其最大的问题就是模板文件的耦合度太高，出了问题谁都不想来解决，前端人员看不到数据，后端人员不懂页面。所以一般的后端都会写js。。不利于前后端分离，降低了开发效率。

## 2.2 前端模板引擎

Ajax的出现使前后端的分离成为可能。后端专注于业务逻辑，给前端提供接口；而前端通过 AJAX 的方式向后端请求数据，然后动态的渲染页面。很好的解决了使用后端模板带来的前后端耦合问题。具体开发场景变成了这样：

数据接口获得数据：

``` javascript
 [{name: "zproo"}, {age: "20"}]
```

要渲染的页面结构：

``` html
<ul class="list">
    <li>null</li>
    <li>null</li>
</ul>
```

将数据应用到页面：

``` javascript
// 假设接口数据
var data = [{name: "zproo"}, {age: "20"}];

var str = "";
str += '<ul class="list">';

for (var i = 0, len = data.length; i < len; i++) {
  if (i !== len - 1)
     str += "<li>" + data[i].name + "</li>";
  else
     str += "<li>" + data[i].age + "</li>";
}

str += "</ul>";
document.querySelector("div").innerHTML = str;
```

出现了！传说中的拼串！！

相信这么干过的都感受过拼串的绝望，当页面显示逻辑或数据复杂之后，你不出错算我输。前端模板引擎解决的就是这个问题。上面介绍过了模板的用法，如果用模板的话我们只需要在数据应该显示的地方设置好变量，而数据怎么应用到页面中的变量上去就是模板引擎的具体工作了。

# 3. 前端模板引擎与前端框架的区别

如果你看了我上面的介绍，并且你还使用过Angular和Vue这样的前端开发框架的话，肯定会觉得前端模板框架和Angular很像吧。是的，他们确实很像，至少在这部分实现的功能是挺像的。

Angular中能够使用指令将数据双向绑定到显示页面上，可以说完全可以覆盖前端模板引擎的功能。但是Angular中双向数据绑定的实现原理肯定是跟模板引擎不同的，而且Angular中还包含MVC架构等很多的框架方面的思想，所以说跟模板引擎的区别还是很明显的。

# 4. 前端框架能够取代模板引擎吗

我上面说了Angular覆盖了前端模板引擎的功能，那我们能用Angular取代模板引擎吗？根据我现在的认知来说，其实是可以取代的。但是有一个我能想到的问题就是Angular这种大而全的前端框架在移动端设备上可能造成的性能问题，尤其是在比较低端的设备上，这也是Angular的一个问题。

# 5.使用前端模板引擎有什么缺点

缺点的话就是老生常谈的SEO问题了，毕竟爬虫只会抓取 HTML 代码，不会去渲染 JS。